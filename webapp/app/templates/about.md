##### Q: Кто вы?
**A**: Мы -- Штех Геннадий и Иван Меньших, немного работаем с машинным обучением и данными, учимся в магистратуре ИМКН УрФУ.
Этот проект мы начали в рамках проектного спецкурса, но после получения зачёта останавливаться не захотелось, и мы попробовали довести проект до "продукта": хостинг, пользователи, обработка обратной связи.

Базовый функционал поиска мы сделали за 2 уикэнда + неделя машинных усилий на краулинг. Хостинг, сервисы, "пользователебезопасность" -- еще 2 уикэнда. Еще некоторое время уйдёт на тюнинг моделей, пока не известно, сколько.


##### Q: Зачем вы это сделали?
**A**: Базовый функционал этого проекта появился благодаря спецкурсу А. Созыкина(линк на Созыкина) в магистратуре ИМКН УрФУ(линк на имкн) по параллельным вычислениям.
Это был проектный спецкурс, задача стояла так: сделать что-то прикольное с параллельными вычислениями на картинках в соцсетях. Авторы данного проекта решили сделать поиск и аннотирование картинок, используя фотогалереи Вконтакта в качестве датасета.
Мы выкачали фотоальбомы(фото+тексты-комментарии) пользователей Екатеринбурга, отфильтровали откровенный трэш и рекламу, на оставшихся 80 000 парах фото+комментарий мы обучили наши модели(ARTM+Inception-v3).

Для проекта этого было достаточно, но мы пошли дальше и сделали данный веб сервис просто ради фана и опыта запуска продуктов.

##### Q: Как это работает?
**A**: Можно загружать картинки, их описания, можно делать это одновременно. В ответ вы будете получать записи из нашей базы, которые релевантны этому запросу. Так же к вашему запросу будут подобраны ключевые слова. Например, в случае, если в вашем запросе была только картинка, мы предложим ключевые слова к ней и похожие на неё записи из нашей базы.

##### Q: Как это устроено?
**A**:
 - Поиск:
   - Краулером скачиваем открытые альбомы пользователей, отбираем оттуда данные с достаточным(>20) количеством слов.
   - Вычищаем рекламу линейным классификатором по текстам.
   - Все фотки преобразуем в дискретное представление("классы") с помощью предобученной нейросети Inception-v3 и некоторого пост-процессинга.
   - Все тексты токенизируем и нормализуем лемматизацией, вытаскиваем оттуда хештэги.
   Теперь для каждого поста у нас есть 3 поля: "классы" картинки, токены из комментария, хештэги. Каждый пост мы называем "документом", а его поля мы называем "модальностями".
   - Затем мы загружаем документы в специально подобранную мультимодальную тематическую модель, которая для каждого документа строит стохастический тематический вектор, он показывает пропорцию содержания "тем" в данном документе.
   Этот вектор используется для поиска:
    - Для данного документа мы строим его тематический вектор
    - Находим ближайшие(по cosine/minkowski_1) к нему известные нам точки
    - Предлагаем их в качестве поисковой выдачи.
 - Аннотация:
   - При этом документ может не содержать некоторых модальностей, например может состоять только из картинки или только из текста. Кроме того тематическую модель можно обратить. Например:
    - Для данной картинки получить тематический вектор.
    - На основе тематического вектора построить набор наиболее вероятных слов при данной тематике.
    - Выбрать топ-10 по вероятности слов из получившегося распределения.

*Технические подробности об устройстве поискового движка читайте на хабре.*

##### Q: Откуда взяты данные?
**A**: Источником данных послужили открытые фотоальбомы пользователей Вконтакте из Екатеринбурга. Мы отфильтровали их от рекламы и слегка предобработали тексты при них.

В фото и комментариях может попасться любая жесть, извините.


##### Q: Сколько будет жить сервис?
**A**: Я не знаю. Возможно, несколько месяцев, на предоплаченный период аренды сервера. Если(вдруг!) нам не придётся платить за сервера -- то возможно сервис проживёт дольше.

Сам сервис развёрнут на Хецнере. Он кушает около 3000 рублей в месяц.


##### Q: Каковы дальнейшие планы?
**A**: Я не знаю. Очевидно, это не тот сервис, который полюбят пользователи и будут нести нам деньги за его использование. Гипотетически, можно было бы прикрутить лучший движок для аннотации(на RNN или марковских цепях с сидом из ARTM), можно сделать более специализированный дискретный преобразователь изображений, заточиться на короткие текстовые запросы, строить иерархический тематический поиск.

Если есть идеи или желание что-то такое сделать -- пишите нам, нам было бы интересно развивать эти идеи.


##### Q: Прикольно сделали!
**A**: Спасибо. :)

Вы можете помочь советом в issue гитхаба, или монетой удобным для вас способом(возможные способы перечислены ниже).





## Спасибо за внимание!


### Способы поддержать:

**BTC-кошелёк:** 1PbnTmkXuwSm8XVz7zD2SckNknosQdhxLE

**Кнопка доната через Яндекс.Деньги:**
<iframe frameborder="0" allowtransparency="true" scrolling="no" src="https://money.yandex.ru/embed/donate.xml?account=410013862814441&quickpay=donate&payment-type-choice=on&mobile-payment-type-choice=on&default-sum=139&targets=%D0%A1%D1%82%D1%83%D0%B4%D0%B5%D0%BD%D1%82%D0%B0%D0%BC+%D0%BD%D0%B0+%D1%81%D0%B5%D1%80%D0%B2%D0%B5%D1%80%D0%B0&target-visibility=on&project-name=Image2pic&project-site=image2pic.tech&button-text=05&successURL=" width="509" height="117"></iframe>

**Кнопка доната через paypal:** <form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top">
<input type="hidden" name="cmd" value="_s-xclick">
<input type="hidden" name="hosted_button_id" value="U3WYZVJRKB5V8">
<input type="image" src="https://www.paypalobjects.com/en_US/RU/i/btn/btn_donateCC_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
<img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
</form>

**Личный перевод paypal:** https://www.paypal.me/sht3ch

https://github.com/menshikh-iv/image2pic -- здесь есть код и ссылки на использованные фреймворки



%%%% Яндекс генерируется тут https://money.yandex.ru/embed/quickpay/donate.xml
